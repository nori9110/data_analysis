# AI分析アドバイス機能 プロンプトカスタマイズ対応版仕様書

## 目次
1. [UI構成の更新](#1-ui構成の更新)
2. [プロンプト機能の詳細仕様](#2-プロンプト機能の詳細仕様)
3. [プロンプト関連の機能フロー](#3-プロンプト関連の機能フロー)
4. [プロンプト設定の保存機能](#4-プロンプト設定の保存機能)
5. [プロンプト最適化機能](#5-プロンプト最適化機能)
6. [エラーハンドリング](#6-エラーハンドリング)
7. [レスポンシブ対応](#7-レスポンシブ対応)
8. [多言語対応](#8-多言語対応)

## 1. UI構成の更新
### 1.1 AI分析モーダルウィンドウの新レイアウト

```
+------------------------------------------+
|  AI分析アドバイス                        |
|  [×] 閉じる                             |
+------------------------------------------+
|  ■ 分析対象：[選択した分析項目]         |
|  ■ 分析期間：YYYY/MM-YYYY/MM            |
+------------------------------------------+
|  ■ プロンプト設定                        |
|    ○ クイックプロンプト選択             |
|      [ドロップダウンメニュー▼]          |
|    ○ カスタムプロンプト                 |
|      [テキストエリア]                    |
|      文字数: 0/1000                      |
+------------------------------------------+
|  □ 分析中のアニメーション               |
|                                          |
|  ■ AIからのアドバイス                   |
|    ・概要                                |
|    ・詳細分析                            |
|    ・推奨アクション                      |
+------------------------------------------+
|  ■ アクション                            |
|    [分析開始] [保存] [共有] [閉じる]    |
+------------------------------------------+
```

## 2. プロンプト機能の詳細仕様
### 2.1 クイックプロンプト選択
#### 基本プロンプトテンプレート

**売上分析向け：**
- 「売上トレンドを分析し、重要なパターンと改善機会を提案してください」
- 「前年同期比での変化点と要因を分析してください」
- 「売上の季節性と対策について提案してください」

**商品分析向け：**
- 「商品カテゴリー別のパフォーマンスを評価し、改善点を提示してください」
- 「商品間の相関関係を分析し、クロスセル機会を特定してください」
- 「在庫回転率の観点から商品戦略を提案してください」

**顧客分析向け：**
- 「顧客セグメント別の特徴と対応戦略を提案してください」
- 「優良顧客の特徴を分析し、類似顧客の開拓方法を提案してください」
- 「顧客離反リスクの兆候と防止策を分析してください」

### 2.2 カスタムプロンプト入力機能
#### 入力フィールド仕様
- 最大文字数：1000文字
- プレースホルダーテキスト：「分析の視点や確認したいポイントを入力してください」
- リアルタイム文字数カウンター
- 入力支援機能：
  - キーワード候補の表示
  - プロンプトの構文ハイライト

#### プロンプトビルダー補助機能
```
■ プロンプト構成要素選択（チェックボックス）
□ データの特徴分析
□ 問題点の抽出
□ 改善提案
□ 具体的なアクションプラン
□ 数値目標の設定
□ 競合分析の視点
□ リスク分析

■ 分析深度選択
○ 概要レベル
○ 標準レベル
○ 詳細レベル

■ 出力形式選択
□ 箇条書き
□ 段落形式
□ 表形式
□ アクションプラン形式
```

### 2.3 プロンプト履歴管理
- 最近使用したプロンプト
  - 最新5件を表示
  - お気に入り登録機能
  - 編集・再利用機能
- プロンプトライブラリ
  - カテゴリー別保存
  - タグ付け機能
  - 検索機能

## 3. プロンプト関連の機能フロー
### 3.1 基本フロー
1. 分析種別の選択
2. プロンプト方式の選択（クイック/カスタム）
3. プロンプトの入力/選択
4. プロンプトのプレビュー
5. 分析実行
6. 結果の表示

### 3.2 プロンプトのバリデーション
- 最小文字数チェック（20文字以上）
- 禁止語句のチェック
- 文脈の整合性チェック
- 専門用語のサジェスト

## 4. プロンプト設定の保存機能
### 4.1 保存項目
```json
{
  "prompt_id": "uuid",
  "prompt_type": "custom/quick",
  "prompt_text": "プロンプト本文",
  "analysis_type": "sales/product/customer",
  "created_at": "timestamp",
  "last_used": "timestamp",
  "favorite": boolean,
  "tags": ["tag1", "tag2"],
  "success_rate": float,
  "user_rating": integer
}
```

### 4.2 プロンプトの共有機能
- チーム内での共有
- ベストプラクティスの保存
- 評価とフィードバック機能

## 5. プロンプト最適化機能
### 5.1 自動最適化
- 成功率の高いプロンプトの学習
- キーワードの効果分析
- 文脈の最適化提案

### 5.2 フィードバックループ
- 分析結果の評価機能
- プロンプトの改善提案
- 効果測定とレポーティング

## 6. エラーハンドリング
### 6.1 プロンプト関連エラー
- 文字数制限超過
- 不適切な内容の検出
- 文脈エラーの指摘
- 代替プロンプトの提案

### 6.2 ユーザーガイダンス
- エラーメッセージの表示
- 修正提案の提示
- ヘルプ情報の提供

## 7. レスポンシブ対応
### 7.1 入力フィールドの調整
- モバイル向けキーボード最適化
- タッチインターフェース対応
- 画面サイズに応じたレイアウト変更

## 8. 多言語対応
- 日本語/英語プロンプトの切り替え
- 言語別テンプレート
- 自動翻訳機能 